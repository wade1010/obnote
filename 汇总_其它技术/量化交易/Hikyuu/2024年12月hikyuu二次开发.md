## åŸºç¡€ä¾èµ–

xmake  ç¼–è¯‘å™¨ï¼ˆè¿™é‡Œæ˜¯msvc2022 17.9.1ï¼‰

![image.png](https://gitee.com/hxc8/images9/raw/master/img/202412012134506.png)


vsç‰ˆæœ¬ 2022 17.9.1

## åˆ›å»ºpythonç¯å¢ƒ
~~conda create -n hikyuu python=3.12~~


~~git clone --depth=1 https://github.com/fasiondog/hikyuu.git --recursive~~

~~è¿›å…¥æ ¹ç›®å½•~~

~~pip install -r requirements.txt~~

~~å¦‚æœéœ€è¦ï¼Œå°±è®¾ç½®ç§‘å­¦ä»£ç†~~

~~python setup.py build -j 8  (æ ¹æ®æ ¸æ•°è°ƒæ•´)~~

åæ¥å‘ç°xtquantä¸æ”¯æŒ3.12ã€‚åˆé€€åˆ°3.10

conda create -n hikyuu python=3.10

é‡æ–°æ‰§è¡Œä¸Šè¿°å‡ ä¸ªæ­¥éª¤


git clone --depth=1 https://github.com/fasiondog/hikyuu.git --recursive

è¿›å…¥æ ¹ç›®å½•

pip install -r requirements.txt

å¦‚æœéœ€è¦ï¼Œå°±è®¾ç½®ç§‘å­¦ä»£ç†

## ç¼–è¯‘

python setup.py build -j 8  (æ ¹æ®æ ¸æ•°è°ƒæ•´)


å¦‚æœæŠ¥é”™ï¼ˆä¾‹å¦‚ï¼šand we can run `xmake g --pkg_searchdirs=/xxx` to set the search directories.ï¼‰ï¼Œå¦‚ä¸‹æ—¥å¿—ï¼š
```
(hikyuu) D:\workspace\hikyuu>python setup.py build -j 16         
checking xmake ...
xmake v2.9.6+HEAD.abd15c255, A cross-platform build utility based on Lua
Copyright (C) 2015-present Ruki Wang, tboox.org, xmake.io
                         _
    __  ___ __  __  __ _| | ______
    \ \/ / |  \/  |/ _  | |/ / __ \
     >  <  | \__/ | /_| |   <  ___/
    /_/\_\_|_|  |_|\__ \|_|\_\____|
                         by ruki, xmake.io
    
    ğŸ‘‰  Manual: https://xmake.io/#/getting_started
    ğŸ™  Donate: https://xmake.io/#/sponsor

current python version: 3.10
xmake f  -c -y -m release --feedback=True -k shared --low_precision=False --log_level=2
checking for platform ... windows
checking for architecture ... x64
checking for Microsoft Visual Studio (x64) version ... 2022
checking for Microsoft C/C++ Compiler (x64) version ... 19.39.33520
updating repositories .. ok
  => download https://github.com/doctest/doctest/archive/refs/tags/v2.4.11.tar.gz .. ok
  => install doctest 2.4.11 .. ok
  => download https://gitee.com/fasiondog/hikyuu_extern_libs/releases/download/1.0.0/hdf5-1.12.2-win-x64.zip .. ok
  => install hdf5 1.12.2 .. ok
  => download https://gitee.com/fasiondog/hikyuu_extern_libs/releases/download/1.0.0/mysql-8.0.21-win-x64.zip .. ok
  => install mysql 8.0.21 .. ok
  => download https://github.com/nanomsg/nng/archive/v1.8.0.zip .. ok  
  => download https://github.com/nlohmann/json/archive/v3.11.3.tar.gz .. ok
  => install nlohmann_json v3.11.3 .. ok
  => install nng 1.8.0 .. ok
  => download https://sqlite.org/2024/sqlite-autoconf-3460000.tar.gz .. ok
  => install sqlite3 3.46.0+0 .. ok
  => download https://github.com/xmake-mirror/build-artifacts/releases/download/flatbuffers-v24.3.25/windows-x64-vc14.29.30133-bf7ce6cc2ad94e7ea7efecb381b69bf8.7z .. failed

we can also download these packages manually:
  - https://github.com/xmake-mirror/build-artifacts/releases/download/flatbuffers-v24.3.25/windows-x64-vc14.29.30133-bf7ce6cc2ad94e7ea7efecb381b69bf8.7z
to the local search directories:
  - flatbuffers-v24.3.25.7z, windows-x64-vc14.29.30133-bf7ce6cc2ad94e7ea7efecb381b69bf8.7z
and we can run `xmake g --pkg_searchdirs=/xxx` to set the search directories.
error: curl: (56) Recv failure: Connection was reset

warning: add_cxflags("-fPIC") is ignored, please pass `{force = true}` or call `set_policy("check.auto_ignore_flags", false)` if you want to set it.
xmake -j 16 -b  core
checking for platform ... windows
checking for architecture ... x64
checking for Microsoft Visual Studio (x64) version ... 2022
checking for Microsoft C/C++ Compiler (x64) version ... 19.39.33520
note: install or modify (m) these packages (pass -y to skip confirm)?
in hikyuu-repo:
  -> hdf5 1.12.2 [runtimes:"MT"]
  -> mysql 8.0.21 [runtimes:"MT"]
in xmake-repo:
  -> boost 1.86.0 [filesystem:n, runtimes:"MT", system:n, serialization:y, python:n, shared:y, cmake:n, date_time:y, multi:y]
  -> fmt 11.0.2 [runtimes:"MT", header_only:y, from:spdlog]
  -> spdlog v1.15.0 [header_only:y, fmt_external:y, runtimes:"MT"]
  -> sqlite3 3.46.0+0 [shared:y, safe_mode:"2", runtimes:"MT", cxflags:"-fPIC"]
  -> flatbuffers v24.3.25 [runtimes:"MT"]
  -> nng 1.8.0 [cxflags:"-fPIC", NNG_ENABLE_TLS:n, runtimes:"MT"]
please input: y (y/n/m)
```
![image.png](https://gitee.com/hxc8/images10/raw/master/img/202412021257962.png)


![image.png](https://gitee.com/hxc8/images10/raw/master/img/202412021257020.png)




2024-12-1 22:30å¼€å§‹æ‰§è¡Œ
2024-12-1 23:01æ‰§è¡Œç»“æŸ
![image.png](https://gitee.com/hxc8/images9/raw/master/img/202412012303302.png)


å®˜æ–¹æ–‡æ¡£é‡Œé¢å†™çš„æ˜¯ python setup.py install å°†hikyuuï¼Œå®‰è£…åˆ°site-packagesä¸‹é¢ï¼Œè¿™ä¸ªæœ‰ä¸¤ä¸ªå°é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯pip listé‡Œé¢çœ‹ä¸åˆ°hikyuuï¼ˆä½†æ˜¯ç¡®å®æ˜¯å¯ä»¥importçš„ï¼‰ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯æ¯æ¬¡ä¿®æ”¹éƒ½æ˜¯éœ€è¦é‡æ–°installã€‚

è¿™é‡Œæˆ‘ä¿®æ”¹äº†hikyuu/hikyuu/setup.py(è¿™ä¸ªæ–‡ä»¶ï¼Œä½œè€…åº”è¯¥å¾ˆä¹…ä¸æ›´æ–°äº†)ï¼Œæˆ‘ä¿®æ”¹å¦‚ä¸‹

```
#!/usr/bin/env python  
#-*- coding:utf-8 -*-  
  
import platform  
import sys  
import os  
try:  
    from setuptools import find_packages, setup  
except ImportError:  
    from distutils.core import find_packages, setup  
  
if sys.argv[-1] == 'publish':  
    os.system("python setup.py bdist_wheel --python-tag cp35 -p win-amd64")  
    #python setup.py bdist_wheel --python-tag cp35 -p linux_x86_64  
    os.system("twine upload dist/*")  
    sys.exit()  
  
  
def parse_requirements(filename):  
    line_iter = (line.strip() for line in open(filename))  
    return [line for line in line_iter if line and not line.startswith('#')]  
  
  
requirements = parse_requirements('../requirements.txt')  
  
hku_name = "Hikyuu"  
  
hku_version = ''  
with open('../xmake.lua', 'r', encoding='utf-8') as f:  
    for line in f:  
        if len(line) > 15 and line[:11] == 'set_version':  
            pre_pos = line.find('"') + 1  
            end_pos = line.find('"', pre_pos)  
            hku_version = line[pre_pos:end_pos]  
            break  
  
if not hku_version:  
    print("æ— æ³•åœ¨ xmake.lua ä¸­æ‰¾åˆ° set_version è¯­å¥ï¼Œè·å–ç‰ˆæœ¬å·å¤±è´¥ï¼")  
    exit(0)  
  
print('current hikyuu version:', hku_version)  
  
py_version = platform.python_version_tuple()  
py_version = int(py_version[0]) * 10 + int(py_version[1])  
  
  
hku_author = "fasiondog"  
hku_author_email = "fasiondog@sina.com"  
  
hku_license = "MIT"  
hku_keywords = [  
    "quant", "trade", "System Trading", "backtester", "é‡åŒ–", "ç¨‹åºåŒ–äº¤æ˜“", "é‡åŒ–äº¤æ˜“",  
    "ç³»ç»Ÿäº¤æ˜“"  
]  
hku_platforms = "Independant"  
hku_url = "http://hikyuu.org/"  
  
hku_description = "Hikyuu Quant Framework for System Trading Analysis and backtester"  
with open("../readme.md", encoding='utf-8') as f:  
    hku_long_description = f.read()  
  
  
hku_data_files = []  
  
setup(  
        name = hku_name,  
        version = hku_version,  
        description = hku_description,  
        long_description_content_type='text/markdown',  
        long_description = hku_long_description,  
        author = hku_author,  
        author_email = hku_author_email,  
        license = hku_license,  
        keywords = hku_keywords,  
        platforms = hku_platforms,  
        url = hku_url,  
  
        packages = find_packages(),  
        zip_safe = False,  
        include_package_data=True,  
        package_data={  
            '': [  
                '*.rst', '*.pyd', '*.png', '*.md', '*.ipynb', '*.ini', '*.sql', '*.properties', '*.xml',  
                'LICENSE.txt', '*.dll', '*.exe', '*.ico', '*.so', '*.dylib', '*.h', '*.lib',  
                '*.so.*', '*.qm', 'libboost_serialization*',  
                'libboost_python{}*'.format(py_version)  
            ],  
        },  
  
        data_files = hku_data_files,  
  
        classifiers=[  
            # How mature is this project? Common values are  
            #   3 - Alpha            #   4 - Beta            #   5 - Production/Stable            'Development Status :: 3 - Alpha',  
  
            # Indicate who your project is intended for  
            'Intended Audience :: Developers',  
            'Topic :: Software Development :: Libraries :: Python Modules',  
            'Topic :: Office/Business :: Financial',  
            'Topic :: Office/Business :: Financial :: Investment',  
            'Topic :: Scientific/Engineering :: Mathematics',  
  
            # Pick your license as you wish (should match "license" above)  
            'License :: OSI Approved :: MIT License',  
            'Operating System :: Microsoft :: Windows',  
            'Operating System :: POSIX :: Linux',  
            'Operating System :: MacOS :: MacOS X',  
  
            # Specify the Python versions you support here. In particular, ensure  
            # that you indicate whether you support Python 2, Python 3 or both.            'Programming Language :: Python :: 3',  
            'Programming Language :: Python :: 3.8',  
            'Programming Language :: Python :: 3.9',  
            'Programming Language :: Python :: 3.10',  
            'Programming Language :: Python :: 3.11',  
            'Programming Language :: Python :: 3.12',  
            'Programming Language :: Python :: 3.13',  
        ],  
  
        entry_points={  
            # win11ä¸‹ä½¿ç”¨ GUI æ–¹å¼ï¼Œä¼šç«‹åˆ» timeoutï¼Œå¯¼è‡´æ— æ³•ä¸‹è½½  
            # 'gui_scripts': [  
            #     'HikyuuTDX=hikyuu.gui.HikyuuTDX:start',            # ],            'console_scripts': [  
                'HikyuuTDX=hikyuu.gui.HikyuuTDX:start',  
                'importdata=hikyuu.gui.importdata:main',  
            ]  
        },  
        install_requires=requirements,  
        )
```


ç„¶åæ‰§è¡Œ 

```
python setup.py uninstall
```

è¿›è¡Œå¼€å‘é“¾æ¥

```
cd hikyuu
pip install -e .
```
 ä½†æ˜¯è¿™ä¸ªï¼Œä¸èƒ½åœ¨åˆ«çš„é¡¹ç›®é‡Œé¢å¼•ç”¨ï¼ˆæ¯”å¦‚ï¼š import hikyuuï¼‰




## æ‰“æˆwheelåŒ…







