[https://zhuanlan.zhihu.com/p/119033903](https://zhuanlan.zhihu.com/p/119033903)

一边研究vnpy的时候，偶尔发现了另一开源项目QuantAxis，作者余天，在论坛里被大家称为天神，能独立鼓捣出QuantAxis确实很赞

quantaxis几个特点

1. 实盘封装的接口没有vnpy全，但作为研究学习够了,也没兼容过多数据格式，主要就是mongodb,越简单越好吧，进阶后才需要大而全，早期学习研究简单的系统会容易聚焦在核心

1. 界面UI的部分印象不错，比较清晰, vnpy用的pyqt5做的客户端还是有点别扭不好用

1. Docker部署安装会比vnpy之前采取的conda封装的模式要好(建议vnpy也做docker安装部署), 然后看到vnpy也把之前的conda封装废弃了，开始推一些粉丝做的docker封装了

1. 看到quantaxis里有单独针对股票t+0的日内交易的策略封装，这个很合心意，在a股里的应用场景很频繁

近期研究交易系统的一些体会

1. 要说核心的交易系统吧，看起来不复杂，最基本的事件驱动引擎模式的回测系统有那么20个类几千行代码就ok了

1. 但是，光回测不够啊，得有数据部分，数据又有daily, 分钟，tick, 光免费数据源就一大堆，单一数据源的往往不全，所以这里爬一点哪里爬一点凑齐，这又是一大工作量（收费的是好，但早期大家还不是都是满世界找免费的，这就是小白的通病，在一个事情没推进到看到实际回报前都是能省就省）

1. 数据好不容易解决，还得有实时行情订阅和实盘，这就得 封装券商接口，这就又是几十个接口，ctp, xtp, 飞马，还有数字货币等等，好在vnpy这块做的很全了，直接拿来用，这又是不小的代码量

1. 回测，数据，实盘都有了，不能没有界面，界面又得看是做桌面客户端还是web，其实还是一步到位做web吧，将来都是云端部署团队协作，用在本地电脑单机客户端的情况还是比较少，又是一大工作量

说了一堆，上一个 刚做的quantaxis的脑图，脑图是个好东西，分析代码，做读书笔记有神效

![](https://gitee.com/hxc8/images5/raw/master/img/202407172348699.jpg)

要点

1. quantaxis确实是 比较 接近 可以 实盘的生产系统，该有的基本都有了，数据源，因子分析，webkit等等，包括一些实盘的一些涉及运维的工作也都涵盖了，包括一些定时心跳的检查。

1. qacmd里内容不多，主要是命令行输入的入口， qafetch里包含了众多的数据源，基本可以获得完整的历史行情和一些股票的财务数据, qautil里有很多丰富的工具函数，qaarp这里的arp是 account, risk, portfolio的缩写，里边实现了账户类，风险类和资产组合类。 analysis是一些常规的 回测结果分析. qafactor是 因子分析. qaindicator是各种结束指标. qamarket里 有回测撮合逻辑还有一些 模拟盘和实盘的 接口调用

从这个 quantaxis里 其实对比其他 开源框架，本质差异并不大，不过qa把数据部分和 因子分析/技术指标也一并纳入 是 个亮点，反倒是 围绕在quantaxis以外 很多和实际 生产环境相关的 包 ，也很值得学习分析，包括 webserver, 生产环境的监控， 账号的动态显示， 实盘行情数据流等等，如果只是单独一个 回测/模拟盘 ，那只是一个本地投研框架，如果 把适合实盘的各种模块全部串起来，才是真正可以全天候适配各种市场的实盘系统.

借着qa的结构 说说 一个 量化投研&交易平台的 内部逻辑：

account, risk, portfolio, broker, market, user, factor, indicator, feed, strategy. 你假设面前迎面走了这一堆的英文，把他们都假设为一个个的小人，这是一个方阵，各个小人各司其职,account,user,portfolio可以划为一组，分别是 账户，用户， 投资组合， user用户这个小人官最大， 它可以管着多个account账号和portfolio组合，你也可以就把他假想为一家基金的基金经理，他可以随时查看所有账号的收益情况和自己资产组合的一览，当然这对玩量化的散户来说，有点用牛刀的意思了，但对大规模的基金，是有必要的。broker可以理解为 从 本地虚拟的投研对接到 回测/模拟盘/实盘的 一个 接口层， 这个接口层 就好比铁道上的一个 扳岔口的扳手，往这里扳就是回测的路，往哪里扳就一键切换到模拟盘，再一扳就到实盘了，实盘呢又分为股票/期货等等市场，然后又有不同的接口，所以broker就是决定了你打算走那条路，market实际和broker也是一体的，它包含了刚才提到的 股票/期货等等市场，而面对各种市场，你需要处理对应的账户， 订单分发等等逻辑。 factor和indicator一个是因子，一个是技术指标，因子包括丰富和日渐完善的因子库，同时factor里也可以写一套自己熟悉的因子分析框架，indicator是各种技术指标了，除了常见的macd,rsi等，也可以自己发明一套自己的独门秘籍。feed是数据"投喂"，因为feed这个英文的意思大概就是“喂”，也蛮形象，qa里是用fetch来做数据获取，也比较形象，fetch就是“抓取”,"拉下来". risk和strategy就好解释了， 一个是风险控制，一个是策略基类。 以上这一个方阵就可以浩浩荡荡的组成一个量化平台的方阵了，你就可以带着他们捉对进入市场去拼搏了，每个小人都不能偷懒，一个新的bar, tick来了，都要立刻行动起来接受onbar和ontick的处理，有的会去更新收益，有的会去计算账户的变化，有的会计算回测结果，有的会生成交易的信号signal...