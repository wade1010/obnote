前端笔记

[https://www.yuque.com/cessstudy/kak11d/hfeef2](https://www.yuque.com/cessstudy/kak11d/hfeef2)

笔记md5版3

[https://gitee.com/gaohan888/note](https://gitee.com/gaohan888/note)

课程资料

[尚硅谷_前端技术_Vue全家桶.pdf](attachments/WEBRESOURCE1ac7b79504e090261f609f651ab3b231尚硅谷_前端技术_Vue全家桶.pdf)

代码

[代码.zip](attachments/WEBRESOURCE742d428b93452d4d507a51ecf6f29441代码.zip)

代码目录结构如下图：

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741998.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741017.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741192.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741498.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741586.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741778.jpg)

上图没有体现的3个生命周期钩子：

1、nextTick

2、3、路由独有的activated  deactivated  

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741030.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741935.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741094.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741755.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741451.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741950.jpg)

监视对象的子属性

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741781.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741168.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741495.jpg)

watch简写  只有handler的时候可以简写

![](D:/download/youdaonote-pull-master/data/Technology/前端/JS/VUE/images/WEBRESOURCE39d763e7333b499e5626c1a12a366fd1截图.png)

$watch用法

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741490.jpg)

watch和computed的区别

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741098.jpg)

两个重要小原则：

1、所有被Vue管理的函数，最好写成普通函数，这样this的指向才是vm或者组件实例对象

2、所有不被Vue所管理的函数(定时器的回调函数、Ajax的回调函数、promise的回调函数等)，最好协程箭头函数，这样this的指向才是vm或组件实例对象。

绑定class样式

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741568.jpg)

style 对象绑定

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741265.jpg)

v-if v-show

需求如果n===1的时候就显示h2标签

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741664.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741717.jpg)

上面加了div，就破坏了结构，可以将div改成template，不会破坏结构

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741029.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741121.jpg)

值得注意，template不能和v-show配合使用

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741573.jpg)

```
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>基本列表</title>
		<script type="text/javascript" src="../js/vue.js"></script>
	</head>
	<body>
		<!-- 
				v-for指令:
						1.用于展示列表数据
						2.语法：v-for="(item, index) in xxx" :key="yyy"
						3.可遍历：数组、对象、字符串（用的很少）、指定次数（用的很少）
		-->
		<!-- 准备好一个容器-->
		<div id="root">
			<!-- 遍历数组 -->
			<h2>人员列表（遍历数组）</h2>
			<ul>
				<li v-for="(p,index) of persons" :key="index">
					{{p.name}}-{{p.age}}
				</li>
			</ul>

			<!-- 遍历对象 -->
			<h2>汽车信息（遍历对象）</h2>
			<ul>
				<li v-for="(value,k) of car" :key="k">
					{{k}}-{{value}}
				</li>
			</ul>

			<!-- 遍历字符串 -->
			<h2>测试遍历字符串（用得少）</h2>
			<ul>
				<li v-for="(char,index) of str" :key="index">
					{{char}}-{{index}}
				</li>
			</ul>
			
			<!-- 遍历指定次数 -->
			<h2>测试遍历指定次数（用得少）</h2>
			<ul>
				<li v-for="(number,index) of 5" :key="index">
					{{index}}-{{number}}
				</li>
			</ul>
		</div>

		<script type="text/javascript">
			Vue.config.productionTip = false
			
			new Vue({
				el:'#root',
				data:{
					persons:[
						{id:'001',name:'张三',age:18},
						{id:'002',name:'李四',age:19},
						{id:'003',name:'王五',age:20}
					],
					car:{
						name:'奥迪A8',
						price:'70万',
						color:'黑色'
					},
					str:'hello'
				}
			})
		</script>
</html>
```

**key 的作用与原理**

原理

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741837.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741475.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741901.jpg)

```
<title>key的原理</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <h2>人员列表（遍历数组）</h2>
  <button @click.once="add">添加一个老刘</button>
  <ul>
    <li v-for="(p,index) of persons" :key="index">
      {{p.name}}-{{p.age}}
      <input type="text">
    </li>
  </ul>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false
  new Vue({
    el: '#root',
    data: {
      persons: [
        { id: '001', name: '张三', age: 18 },
        { id: '002', name: '李四', age: 19 },
        { id: '003', name: '王五', age: 20 }
      ]
    },
    methods: {
      add() {
        const p = { id: '004', name: '老刘', age: 40 }
        this.persons.unshift(p)
      }
    },
  })
</script>
```

indexOf注意细节

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741106.jpg)

列表过滤。使用computed比较简单

```
<title>列表过滤</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <h2>人员列表</h2>
  <input type="text" placeholder="请输入名字" v-model="keyWord">
  <ul>
    <li v-for="(p,index) of filPersons" :key="p.id">
      {{ p.name }}-{{ p.age }}-{{ p.sex }}
    </li>
  </ul>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false
  // 用 watch 实现
  // #region 
  /* new Vue({
			el: '#root',
			data: {
				keyWord: '',
				persons: [
					{ id: '001', name: '马冬梅', age: 19, sex: '女' },
					{ id: '002', name: '周冬雨', age: 20, sex: '女' },
					{ id: '003', name: '周杰伦', age: 21, sex: '男' },
					{ id: '004', name: '温兆伦', age: 22, sex: '男' }
				],
				filPersons: []
			},
			watch: {
				keyWord: {
					immediate: true,
					handler(val) {
						this.filPersons = this.persons.filter((p) => {
							return p.name.indexOf(val) !== -1
						})
					}
				}
			}
		}) */
  //#endregion

  // 用 computed 实现
  new Vue({
    el: '#root',
    data: {
      keyWord: '',
      persons: [
        { id: '001', name: '马冬梅', age: 19, sex: '女' },
        { id: '002', name: '周冬雨', age: 20, sex: '女' },
        { id: '003', name: '周杰伦', age: 21, sex: '男' },
        { id: '004', name: '温兆伦', age: 22, sex: '男' }
      ]
    },
    computed: {
      filPersons() {
        return this.persons.filter((p) => {
          return p.name.indexOf(this.keyWord) !== -1
        })
      }
    }
  }) 
</script>
```

**Vue 数据监视**

更新时的一个问题

this.persons[0].name='马老师'

this.persons[0].age=20

这是可以监听到数据改变的

但是使用如下操作

this.persons[0] = {id:'001',name:'马老师',age:50,sex:'男'} 更改data数据，Vue不监听，模板不改变

```
<title>更新时的一个问题</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <h2>人员列表</h2>
  <button @click="updateMei">更新马冬梅的信息</button>
  <ul>
    <li v-for="(p,index) of persons" :key="p.id">
      {{p.name}}-{{p.age}}-{{p.sex}}
    </li>
  </ul>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false

  const vm = new Vue({
    el: '#root',
    data: {
      persons: [
        { id: '001', name: '马冬梅', age: 30, sex: '女' },
        { id: '002', name: '周冬雨', age: 31, sex: '女' },
        { id: '003', name: '周杰伦', age: 18, sex: '男' },
        { id: '004', name: '温兆伦', age: 19, sex: '男' }
      ]
    },
    methods: {
      updateMei() {
        // this.persons[0].name = '马老师'	//奏效
        // this.persons[0].age = 50				//奏效
        // this.persons[0].sex = '男'			//奏效
        // this.persons[0] = {id:'001',name:'马老师',age:50,sex:'男'} //不奏效
        this.persons.splice(0, 1, { id: '001', name: '马老师', age: 50, sex: '男' })
      }
    }
  })
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741820.jpg)

**模拟一个数据监测**

```
let data = {
  name: '尚硅谷',
  address: '北京',
}

function Observer(obj) {
  // 汇总对象中所有的属性形成一个数组
  const keys = Object.keys(obj)
  // 遍历
  keys.forEach((k) => {
    Object.defineProperty(this, k, {
      get() {
        return obj[k]
      },
      set(val) {
        console.log(`${k}被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`)
        obj[k] = val
      }
    })
  })
}

// 创建一个监视的实例对象，用于监视data中属性的变化
const obs = new Observer(data)
console.log(obs)

// 准备一个vm实例对象
let vm = {}
vm._data = data = obs
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741592.jpg)

```
Vue监视数据的原理：
	1. vue会监视data中所有层次的数据。

	2. 如何监测对象中的数据？
					通过setter实现监视，且要在new Vue时就传入要监测的数据。
						(1).对象中后追加的属性，Vue默认不做响应式处理
						(2).如需给后添加的属性做响应式，请使用如下API：
										Vue.set(target，propertyName/index，value) 或 
										vm.$set(target，propertyName/index，value)

	3. 如何监测数组中的数据？
						通过包裹数组更新元素的方法实现，本质就是做了两件事：
							(1).调用原生对应的方法对数组进行更新。
							(2).重新解析模板，进而更新页面。

	4.在Vue修改数组中的某个元素一定要用如下方法：
				1.使用这些API:push()、pop()、shift()、unshift()、splice()、sort()、reverse()
				2.Vue.set() 或 vm.$set()
	
	特别注意：Vue.set() 和 vm.$set() 不能给vm 或 vm的根数据对象 添加属性！！！
```

```
<title>总结数据监视</title>
<style>button {margin-top: 10px;}</style>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <h1>学生信息</h1>
  <button @click="student.age++">年龄+1岁</button> <br />
  <button @click="addSex">添加性别属性，默认值：男</button> <br />
  <button @click="student.sex = '未知' ">修改性别</button> <br />
  <button @click="addFriend">在列表首位添加一个朋友</button> <br />
  <button @click="updateFirstFriendName">修改第一个朋友的名字为：张三</button> <br />
  <button @click="addHobby">添加一个爱好</button> <br />
  <button @click="updateHobby">修改第一个爱好为：开车</button> <br />
  <button @click="removeSmoke">过滤掉爱好中的抽烟</button> <br />
  <h3>姓名：{{ student.name }}</h3>
  <h3>年龄：{{ student.age }}</h3>
  <h3 v-if="student.sex">性别：{{student.sex}}</h3>
  <h3>爱好：</h3>
  <ul>
    <li v-for="(h,index) in student.hobby" :key="index">{{ h }} </li>
  </ul>
  <h3>朋友们：</h3>
  <ul>
    <li v-for="(f,index) in student.friends" :key="index">{{ f.name }}--{{ f.age }}</li>
  </ul>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false

  const vm = new Vue({
    el: '#root',
    data: {
      student: {
        name: 'tom',
        age: 18,
        hobby: ['抽烟', '喝酒', '烫头'],
        friends: [
          { name: 'jerry', age: 35 },
          { name: 'tony', age: 36 }
        ]
      }
    },
    methods: {
      addSex() {
        // Vue.set(this.student,'sex','男')
        this.$set(this.student, 'sex', '男')
      },
      addFriend() {
        this.student.friends.unshift({ name: 'jack', age: 70 })
      },
      updateFirstFriendName() {
        this.student.friends[0].name = '张三'
      },
      addHobby() {
        this.student.hobby.push('学习')
      },
      updateHobby() {
        // this.student.hobby.splice(0,1,'开车')
        // Vue.set(this.student.hobby,0,'开车')
        this.$set(this.student.hobby, 0, '开车')
      },
      removeSmoke() {
        this.student.hobby = this.student.hobby.filter((h) => {
          return h !== '抽烟'
        })
      }
    }
  })
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741448.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741219.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741800.jpg)

```
<title>收集表单数据</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <form @submit.prevent="demo">
    账号：<input type="text" v-model.trim="userInfo.account"> <br /><br />
    密码：<input type="password" v-model="userInfo.password"> <br /><br />
    年龄：<input type="number" v-model.number="userInfo.age"> <br /><br />
    性别：
    男<input type="radio" name="sex" v-model="userInfo.sex" value="male">
    女<input type="radio" name="sex" v-model="userInfo.sex" value="female"> <br /><br />
    爱好：
    学习<input type="checkbox" v-model="userInfo.hobby" value="study">
    打游戏<input type="checkbox" v-model="userInfo.hobby" value="game">
    吃饭<input type="checkbox" v-model="userInfo.hobby" value="eat">
    <br /><br />
    所属校区
    <select v-model="userInfo.city">
      <option value="">请选择校区</option>
      <option value="beijing">北京</option>
      <option value="shanghai">上海</option>
      <option value="shenzhen">深圳</option>
      <option value="wuhan">成都</option>
    </select>
    <br/><br/>
    其他信息：
    <textarea v-model.lazy="userInfo.other"></textarea> <br/><br/>
    <input type="checkbox" v-model="userInfo.agree">阅读并接受
    <a href="https://www.yuque.com/cessstudy">《用户协议》</a>
    <button>提交</button>
  </form>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false

  new Vue({
    el: '#root',
    data: {
      userInfo: {
        account: '',
        password: '',
        age: 18,
        sex: 'female',
        hobby: [],
        city: 'beijing',
        other: '',
        agree: ''
      }
    },
    methods: {
      demo() {
        console.log(JSON.stringify(this.userInfo))
      }
    }
  })
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741485.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741239.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741600.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190741828.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742343.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742374.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742415.jpg)

```
<title>自定义指令</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <h2>{{ name }}</h2>
  <h2>当前的n值是：<span v-text="n"></span> </h2>
  <!-- <h2>放大10倍后的n值是：<span v-big-number="n"></span> </h2> -->
  <h2>放大10倍后的n值是：<span v-big="n"></span> </h2>
  <button @click="n++">点我n+1</button>
  <hr />
  <input type="text" v-fbind:value="n">
</div>

<script type="text/javascript">
  Vue.config.productionTip = false

  // 定义全局指令
  /* Vue.directive('fbind',{
		// 指令与元素成功绑定时（一上来）
		bind(element,binding){
			element.value = binding.value
		},
		// 指令所在元素被插入页面时
		inserted(element,binding){
			element.focus()
		},
		// 指令所在的模板被重新解析时
		update(element,binding){
			element.value = binding.value
		}
	}) */

  new Vue({
    el: '#root',
    data: {
      name: '尚硅谷',
      n: 1
    },
    directives: {
      // big函数何时会被调用？
      // 1.指令与元素成功绑定时（一上来） 2.指令所在的模板被重新解析时
      /* 'big-number'(element,binding){
				// console.log('big')
				element.innerText = binding.value * 10
			}, */
      big(element, binding) {
        console.log('big', this) // 🔴注意此处的 this 是 window
        // console.log('big')
        element.innerText = binding.value * 10
      },
      fbind: {
        // 指令与元素成功绑定时（一上来）
        bind(element, binding) {
          element.value = binding.value
        },
        // 指令所在元素被插入页面时
        inserted(element, binding) {
          element.focus()
        },
        // 指令所在的模板被重新解析时
        update(element, binding) {
          element.value = binding.value
        }
      }
    }
  })
</script>
```

生命周期

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742907.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742487.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742029.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742180.jpg)

**Vue组件化编程**

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742599.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742735.jpg)

```
<title>VueComponent</title>
<script type="text/javascript" src="../js/vue.js"></script>

<div id="root">
  <school></school>
  <hello></hello>
</div>

<script type="text/javascript">
  Vue.config.productionTip = false

  // 定义school组件
  const school = Vue.extend({
    name: 'school',
    template: `
				<div>
					<h2>学校名称：{{name}}</h2>	
					<h2>学校地址：{{address}}</h2>	
					<button @click="showName">点我提示学校名</button>
  			</div>
			`,
    data() {return {name: '尚硅谷',address: '北京'}},
    methods: {showName() {console.log('showName', this)}},
  })

  const test = Vue.extend({
    template: `<span>atguigu</span>`
  })

  // 定义hello组件
  const hello = Vue.extend({
    template: `
				<div>
					<h2>{{msg}}</h2>
					<test></test>	
  			</div>
			`,
    data() {return {msg: '你好啊！'}},
    components: { test }
  })

  // console.log('@',school)
  // console.log('#',hello)

  // 创建vm
  const vm = new Vue({
    el: '#root',
    components: { school, hello }
  })
</script>
```

# 一个重要的内置关系

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742758.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742437.jpg)

prototype:显示原型对象

__proto__：隐式原型对象

脚手架文件结构

```
.文件目录
├── node_modules 
├── public
│   ├── favicon.ico: 页签图标
│   └── index.html: 主页面
├── src
│   ├── assets: 存放静态资源
│   │   └── logo.png
│   │── component: 存放组件
│   │   └── HelloWorld.vue
│   │── App.vue: 汇总所有组件
│   └── main.js: 入口文件
├── .gitignore: git版本管制忽略的配置
├── babel.config.js: babel的配置文件
├── package.json: 应用包配置文件 
├── README.md: 应用描述文件
└── package-lock.json: 包版本控制文件
```

render函数

```
import Vue from 'vue'
import App from './App.vue'

Vue.config.productionTip = false

new Vue({
  el:'#app',
  // render函数功能：将App组件放入容器中
  // 简写形式
  render: h => h(App),
  // 完整形式
  // render(createElement){
  //   return createElement(App)
  // }
})
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742674.jpg)

图片中的[ 配置参考|VueCLI](https://cli.vuejs.org/zh/config/#vue-config-js)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742719.jpg)

```
<template>
  <div>
    <h1 v-text="msg" ref="title"></h1>
    <button ref="btn" @click="showDOM">点我输出上方的DOM元素</button>
    <School ref="sch"/>
  </div>
</template>

<script>
  import School from './components/School'

  export default {
    name:'App',
    components:{ School },
    data() {
      return {
        msg:'欢迎学习Vue！'
      }
    },
    methods: {
      showDOM(){
        console.log(this.$refs.title)	// 真实DOM元素
        console.log(this.$refs.btn)		// 真实DOM元素
        console.log(this.$refs.sch)		// School组件的实例对象（vc）
      }
    },
  }
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742876.jpg)

```
<template>
  <div>
    <Student name="李四" sex="女" :age="18"/>
    <Student name="王五" sex="男" :age="18"/>
  </div>
</template>

<script>
  import Student from './components/Student'

  export default {
    name:'App',
    components:{ Student }
  }
</script>
```

```
<template>
  <div>
    <h1>{{ msg }}</h1>
    <h2>学生姓名：{{ name }}</h2>
    <h2>学生性别：{{ sex }}</h2>
    <h2>学生年龄：{{ myAge + 1 }}</h2>
    <button @click="updateAge">尝试修改收到的年龄</button>
  </div>
</template>

<script>
export default {
  name: "Student",
  data() {
    console.log(this);
    return {
      msg: "我是一个UESTC大学的学生",
      myAge: this.age,
    };
  },
  methods: { updateAge() { this.myAge++; }, },
  // 简单声明接收
  // props:['name','age','sex']

  // 接收的同时对数据进行类型限制
  //   props: {
  //     name: String,
  //     age: Number,
  //     sex: String,
  //   }

  // 接收的同时对数据：进行类型限制+默认值的指定+必要性的限制
  props: {
    name: {
      type: String, 	//name的类型是字符串
      required: true, //name是必要的
    },
    age: {
      type: Number,
      default: 99, //默认值
    },
    sex: {
      type: String,
      required: true,
    },
  },
};
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742020.jpg)

```
var mixin = {
	data: function () {
		return {
    		message: 'hello',
            foo: 'abc'
    	}
  	}
}

new Vue({
  	mixins: [mixin],
  	data () {
    	return {
      		message: 'goodbye',
            	bar: 'def'
    	}
    },
  	created () {
    	console.log(this.$data)
    	// => { message: "goodbye", foo: "abc", bar: "def" }
  	}
})
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742194.jpg)

Vue插件

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742322.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742538.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742488.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742631.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742222.jpg)

# 组件的自定义事件

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742301.jpg)

箭头函数没有this,会向外找，找到monted( )，this就是vm

src/app.vue

```
<template>
  <div class="app">
    <h1>{{ msg }}，学生姓名是:{{ studentName }}</h1>
		
    <!-- 通过父组件给子组件传递函数类型的props实现子给父传递数据 -->
    <School :getSchoolName="getSchoolName"/>

    <!-- 通过父组件给子组件绑定一个自定义事件实现子给父传递数据（第一种写法，使用@或v-on） -->
    <!-- <Student @atguigu="getStudentName" @demo="m1"/> -->

    <!-- 通过父组件给子组件绑定一个自定义事件实现子给父传递数据（第二种写法，使用ref） -->
    <Student ref="student" @click.native="show"/> <!-- 🔴native -->
  </div>
</template>

<script>
  import Student from './components/Student'
  import School from './components/School'

  export default {
    name:'App',
    components:{School,Student},
    data() {
      return {
        msg:'你好啊！',
        studentName:''
      }
    },
    methods: {
      getSchoolName(name){
        console.log('App收到了学校名：',name)
      },
      getStudentName(name,...params){
        console.log('App收到了学生名：',name,params)
        this.studentName = name
      },
      m1(){
        console.log('demo事件被触发了！')
      },
      show(){
        alert(123)
      }
    },
    mounted() {
      this.$refs.student.$on('atguigu',this.getStudentName) // 🔴绑定自定义事件
      //还可以延迟多少秒，setTimeout,这个是上方另外几个方法做不到的
      // this.$refs.student.$once('atguigu',this.getStudentName) // 绑定自定义事件（一次性）
    },
  }
</script>

<style scoped>.app{background-color: gray;padding: 5px;}</style>
```

src/components/Student.vue

```
<template>
	<div class="student">
		<h2>学生姓名：{{name}}</h2>
		<h2>学生性别：{{sex}}</h2>
		<h2>当前求和为：{{number}}</h2>
		<button @click="add">点我number++</button>
		<button @click="sendStudentlName">把学生名给App</button>
		<button @click="unbind">解绑atguigu事件</button>
		<button @click="death">销毁当前Student组件的实例(vc)</button>
	</div>
</template>

<script>
	export default {
		name:'Student',
		data() {
			return {
				name:'张三',
				sex:'男',
				number:0
			}
		},
		methods: {
			add(){
				console.log('add回调被调用了')
				this.number++
			},
			sendStudentlName(){
				// 触发Student组件实例身上的atguigu事件
				this.$emit('atguigu',this.name,666,888,900)
				// this.$emit('demo')
				// this.$emit('click')
			},
			unbind(){
        // 🔴解绑
				this.$off('atguigu') //解绑一个自定义事件
				// this.$off(['atguigu','demo']) //解绑多个自定义事件
				// this.$off() //解绑所有的自定义事件
			},
			death(){
        // 销毁了当前Student组件的实例，销毁后所有Student实例的自定义事件全都不奏效
				this.$destroy()
			}
		},
	}
</script>

<style lang="less" scoped>
	.student{background-color: pink;padding: 5px;margin-top: 30px;}
</style>
```

# 全局事件总线

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742394.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742547.jpg)

又要看之前的重要图了

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742758.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742653.jpg)

下图 =vm这行代码顺序不对

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742935.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742076.jpg)

=vm这行代码应该放的在beforecreate这个钩子函数中

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742238.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742247.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742293.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742251.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742393.jpg)

![](D:/download/youdaonote-pull-master/data/Technology/前端/JS/VUE/images/WEBRESOURCE678d0d22e63c0a79b4087c50342aa1a0截图.png)

$nextTick

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742759.jpg)

```
<template>
  <li>
    <label>
      <input type="checkbox" :checked="todo.done" @change="handleCheck(todo.id)"/>
      <span v-show="!todo.isEdit">{{ todo.title }}</span>
      <input type="text" v-show="todo.isEdit" :value="todo.title"
        @blur="handleBlur(todo, $event)" ref="inputTitle"/>
    </label>
    <button class="btn btn-danger" @click="handleDelete(todo.id)">删除</button>
    <button v-show="!todo.isEdit" class="btn btn-edit" @click="handleEdit(todo)">
      编辑
    </button>
  </li>
</template>

<script>
export default {
  name: "MyItem",
  
  props: ["todo"],	// 声明接收todo
  methods: {
    handleCheck(id) {		// 勾选or取消勾选
      // 通知App组件将对应的todo对象的done值取反
      // this.checkTodo(id)
      this.$bus.$emit("checkTodo", id);
    },
    handleDelete(id) {	// 删除
      if (confirm("确定删除吗？")) {
        // 通知App组件将对应的todo对象删除
        // this.deleteTodo(id)
        this.$bus.$emit('deleteTodo',id)
      }
    },
    handleEdit(todo) {	// 编辑
      if (todo.hasOwnProperty("isEdit")) {
        todo.isEdit = true;
      } else {
        this.$set(todo, "isEdit", true);
      }
      this.$nextTick(function () {
        this.$refs.inputTitle.focus();
      });
    },
    handleBlur(todo, e) {	// 失去焦点回调（真正执行修改逻辑）
      todo.isEdit = false;
      if (!e.target.value.trim()) return alert("输入不能为空！");
      this.$bus.$emit("updateTodo", todo.id, e.target.value);
    },
  },
};
</script>
```

默认插槽

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742855.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742026.jpg)

**v-slot:xxx  **必须作用在template上面，不能作用在div上面

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742123.jpg)

第三行，必须使用template

```
父组件中：
        <Category>
            <template scope="scopeData">
                <!-- 生成的是ul列表 -->
                <ul>
                  <li v-for="g in scopeData.games" :key="g">{{g}}</li>
                </ul>
            </template>
        </Category>

        <Category>
            <template slot-scope="scopeData">
                <!-- 生成的是h4标题 -->
                <h4 v-for="g in scopeData.games" :key="g">{{g}}</h4>
            </template>
        </Category>
        
         <Category>
            <template slot-scope="{games}">
                <!-- 生成的是h4标题 -->
                <h4 v-for="g in games" :key="g">{{g}}</h4>
            </template>
        </Category>
        
子组件中：
        <template>
            <div>
                <slot :games="games"></slot>
            </div>
        </template>
		
        <script>
            export default {
                name:'Category',
                props:['title'],
                //数据在子组件自身
                data() {
                    return {
                        games:['红色警戒','穿越火线','劲舞团','超级玛丽']
                    }
                },
            }
        </script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742200.jpg)

VueX

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742198.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742434.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742572.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742561.jpg)

VuxX工作原理图

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742557.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742683.jpg)

如果知道加几，比如知道sum操作是加2，其实不需要走actions了，actions的也有作用，比如不知道加几，这个几需要通过backend API请求，返回的结果才知道。也就是没有业务逻辑的时候可以省略actions

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742994.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742129.jpg)

![](D:/download/youdaonote-pull-master/data/Technology/前端/JS/VUE/images/WEBRESOURCE53ea36e343443ec2c2500d0056818802截图.png)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742430.jpg)

Vue.use(Vuex)之后，new Vue的时候传store才有效。如果没有use，store配置将会被丢弃

准备store

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742802.jpg)

引入store到vm实例对象上

![](https://gitee.com/hxc8/images7/raw/master/img/202407190742972.jpg)

运行后发现上面代码报错

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743098.jpg)

import store from './store'

这里面用到了vuex，

但是这时候vuex还没有被vue.use

尝试改成如下，

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743453.jpg)

发现错误依旧

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743829.jpg)

这是因为脚手架解析import语句时，先扫描文件里面所有的import语句，然后把所有import全部都汇总到最上方

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743937.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743903.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743854.jpg)

控制台输出 

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743087.jpg)

改下顺序

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743139.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743481.jpg)

把vuex引入写在store里面

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743929.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743164.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743507.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743777.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743802.jpg)

```
import Vue from 'vue'
import Vuex from 'vuex'	// 引入Vuex

Vue.use(Vuex)	// 应用Vuex插件

// 准备actions——用于响应组件中的动作
const actions = {
	/* jia(context,value){
		console.log('actions中的jia被调用了')
		context.commit('JIA',value)
	},
	jian(context,value){
		console.log('actions中的jian被调用了')
		context.commit('JIAN',value)
	}, */
	jiaOdd(context,value){	// context 相当于精简版的 $store
		console.log('actions中的jiaOdd被调用了')
		if(context.state.sum % 2){
			context.commit('JIA',value)
		}
	},
	jiaWait(context,value){
		console.log('actions中的jiaWait被调用了')
		setTimeout(()=>{
			context.commit('JIA',value)
		},500)
	}
}
// 准备mutations——用于操作数据（state）
const mutations = {
	JIA(state,value){
		console.log('mutations中的JIA被调用了')
		state.sum += value
	},
	JIAN(state,value){
		console.log('mutations中的JIAN被调用了')
		state.sum -= value
	}
}
// 准备state——用于存储数据
const state = {
	sum:0 //当前的和
}

// 创建并暴露store
export default new Vuex.Store({
	actions,
	mutations,
	state,
})
```

![](D:/download/youdaonote-pull-master/data/Technology/前端/JS/VUE/images/WEBRESOURCE8ff192abe4c9dd13ead4e7e549293e82截图.png)

```
<template>
	<div>
		<h1>当前求和为：{{ $store.state.sum }}</h1>
		<select v-model.number="n">
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
		</select>
		<button @click="increment">+</button>
		<button @click="decrement">-</button>
		<button @click="incrementOdd">当前求和为奇数再加</button>
		<button @click="incrementWait">等一等再加</button>
	</div>
</template>

<script>
	export default {
		name:'Count',
		data() {
			return {
				n:1, //用户选择的数字
			}
		},
		methods: {
			increment(){
				this.$store.commit('JIA',this.n)
			},
			decrement(){
				this.$store.commit('JIAN',this.n)
			},
			incrementOdd(){
				this.$store.dispatch('jiaOdd',this.n)
			},
			incrementWait(){
				this.$store.dispatch('jiaWait',this.n)
			},
		}
	}
</script>

<style lang="css">button{margin-left: 5px;}</style>

```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743489.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743551.jpg)

```
import Vue from 'vue'	// 引入Vue核心库
import Vuex from 'vuex'	// 引入Vuex

Vue.use(Vuex)	// 应用Vuex插件
   
// 准备actions对象——响应组件中用户的动作
const actions = {
    addOdd(context,value){
        console.log("actions中的addOdd被调用了")
        if(context.state.sum % 2){context.commit('ADD',value)}
    },
    addWait(context,value){
        console.log("actions中的addWait被调用了")
        setTimeout(()=>{context.commit('ADD',value)},500)
    },
}
// 准备mutations对象——修改state中的数据
const mutations = {
    ADD(state,value){state.sum += value},
    SUB(state,value){state.sum -= value}
}
// 准备state对象——保存具体的数据
const state = {
    sum:0 // 当前的和
}
// 准备getters对象——用于将state中的数据进行加工
const getters = {
    bigSum(){
        return state.sum * 10
    }
}
   
//创建并暴露store
export default new Vuex.Store({
    actions,
    mutations,
    state,
    getters
})
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743515.jpg)

```
<template>
	<div>
		<h1>当前求和为：{{ $store.state.sum }}</h1>
		<h3>当前求和的10倍为：{{ $store.getters.bigSum }}</h3>
		<select v-model.number="n">
			<option value="1">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
		</select>
		<button @click="increment">+</button>
		<button @click="decrement">-</button>
		<button @click="incrementOdd">当前求和为奇数再加</button>
		<button @click="incrementWait">等一等再加</button>
	</div>
</template>

<script>
	export default {
		name:'Count',
		data() {
			return {
				n:1,
			}
		},
		methods: {
			increment(){this.$store.commit('ADD',this.n)},
			decrement(){this.$store.commit('SUBTRACT',this.n)},
			incrementOdd(){this.$store.dispatch('addOdd',this.n)},
			incrementWait(){this.$store.dispatch('addWait',this.n)},
		},
	}
</script>

<style>button{margin-left: 5px;}</style>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743488.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743772.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743004.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743224.jpg)

路由

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743599.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743615.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743743.jpg)

Vue Router query 命名路由 params props

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743100.jpg)

```
<template>
  <div>
    <ul>
      <li v-for="m in messageList" :key="m.id">
        <!-- 跳转路由并携带query参数，to的字符串写法 -->
        <!-- <router-link :to="`/home/message/detail?id=${m.id}&title=${m.title}`">
                      {{m.title}}
    				 </router-link>&nbsp;&nbsp; -->

        <!-- 跳转路由并携带query参数，to的对象写法 -->
        <router-link :to="{
                            path:'/home/message/detail',
                            query:{
                              id:m.id,
                              title:m.title
                            }
                          }">
          {{m.title}}
      </router-link>&nbsp;&nbsp;
      </li>
    </ul>
    <hr/>
    <router-view></router-view>
  </div>
</template>

<script>
  export default {
    name:'News',
    data(){
      return{
        messageList:[
          {id:'001',title:'消息001'},
          {id:'002',title:'消息002'},
          {id:'003',title:'消息003'}
        ]
      }
    }
  }
</script>
```

```
<template>
    <ul>
        <li>消息编号：{{ $route.query.id }}</li>
        <li>消息标题：{{ $route.query.title }}</li>
    </ul>
</template>

<script>
    export default {
        name:'Detail'
    }
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743359.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743765.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743862.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743898.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743028.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743029.jpg)

路由的 props 配置

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743872.jpg)

```
{
	name:'xiangqing',
	path:'detail/:id',
	component:Detail,

	//第一种写法：props值为对象，该对象中所有的key-value的组合最终都会通过props传给Detail组件
	// props:{a:900}

	//第二种写法：props值为布尔值，为true时，则把路由收到的所有params参数通过props传给Detail组件
	// props:true //不能解析query只能解析params
	
	//第三种写法：props值为函数，该函数返回的对象中每一组key-value都会通过props传给Detail组件
	props($route){
		return {
			id: $route.query.id,
			title: $route.query.title
		}
	}
}
```

```
上面的代码可以是用结构赋值
 	props($route){
		return {
			id: $route.query.id,
			title: $route.query.title
		}
	}
 
 解构赋值方式1
 props({query}){
		return {
			id: query.id,
			title: query.title
		}
	}
 解构赋值连续写法2
  props({query:{id,title}}){
		return {
			id: id,//k v 相同，可以简写为id
			title: title//k v 相同，可以简写为title
		}
	}
```

Vue Router replace 编程式导航 缓存路由组件

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743752.jpg)

```
<template>
  <div>
    <h2>Home组件内容</h2>
    <div>
      <ul class="nav nav-tabs">
        <li>
          <router-link replace class="list-group-item" active-class="active" 
                       to="/home/news">News</router-link>
    		</li>
        <li>
          <router-link replace class="list-group-item" active-class="active" 
                       to="/home/message">Message</router-link>
    		</li>
    </ul>
    <router-view></router-view>
    </div>
  </div>
</template>

<script>
  export default {
    name:'Home'
  }
</script>
```

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743966.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743073.jpg)

Vue Router activated deactivated 路由守卫

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743316.jpg)

```
<template>
    <ul>
        <li :style="{opacity}">欢迎学习vue</li>
        <li>news001 <input type="text"></li>
        <li>news002 <input type="text"></li>
        <li>news003 <input type="text"></li>
    </ul>
</template>

<script>
    export default {
        name:'News',
        data(){
            return{
                opacity:1
            }
        },
        activated(){
            console.log('News组件被激活了')
            this.timer = setInterval(() => {
                this.opacity -= 0.01
                if(this.opacity <= 0) this.opacity = 1
            },16)
        },
        deactivated(){
            console.log('News组件失活了')
            clearInterval(this.timer)
        }
    }
</script>
```

路由守卫

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743581.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743698.jpg)

独享守卫，只有前置路由守卫

```
//该文件专门用于创建整个应用的路由器
import VueRouter from "vue-router";
//引入组件
import Home from '../pages/Home'
import About from '../pages/About'
import News from '../pages/News'
import Message from '../pages/Message'
import Detail from '../pages/Detail'


//创建一个路由器
const router = new VueRouter({
    routes:[
        {
            name:'guanyv',
            path:'/about',
            component:About,
            meta:{title:'关于'}
        },
        {
            name:'zhuye',
            path:'/home',
            component:Home,
            meta:{title:'主页'},
            children:[
                {
                    name:'xinwen',
                    path:'news',
                    component:News,
                    meta:{title:'新闻'},
                    // 🔴独享守卫，特定路由切换之后被调用
                    beforeEnter(to,from,next){
                        console.log('独享路由守卫',to,from)
                        if(localStorage.getItem('school') === 'atguigu'){
                            next()
                        }else{
                            alert('暂无权限查看')
                        }
                    }
                },
                {
                    name:'xiaoxi',
                    path:'message',
                    component:Message,
                    meta:{title:'消息'},
                    children:[
                        {
                            name:'xiangqing',
                            path:'detail',
                            component:Detail,
                            meta:{title:'详情'},
                            props($route){
                                return {
                                    id:$route.query.id,
                                    title:$route.query.title,
                                }
                            }
                        }
                    ]
                }
            ]
        }
    ]
})

//全局后置路由守卫————初始化的时候被调用、每次路由切换之后被调用
router.afterEach((to,from)=>{
	console.log('后置路由守卫',to,from)
	document.title = to.meta.title || '硅谷系统'
})

//导出路由器
export default router
```

组件内路由守卫

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743875.jpg)

![](https://gitee.com/hxc8/images7/raw/master/img/202407190743156.jpg)

node简单的创建server

1 npm init

2 npm i express

3 新建server.js

```
const express = require('express')

const app = express()

app.get('person',(req,res)=>{
     res.send({
         name:'tom',
         age:18     
     })   
})

app.listen(5000,err=>{
    if(!err) console.log('服务器启动成功')
})
```

4 node server.js启动server

5 测试 localhost:5000/person

6 把前端项目 npm run build 之后的dist里面的内容拷贝到 server.js 同级目录，创建一个叫static的目录下。然后使用express.static

```
const express = require('express')

const app = express()
app.use(express.static(__dirname__+'/static'))

app.get('person',(req,res)=>{
     res.send({
         name:'tom',
          age:18     
     })   
})

app.listen(5000,err=>{
    if(!err) console.log('服务器启动成功')
})
```

7 如果vue前端项目路由器模式是默认的hash模式是没有问题的，如果设置的是history模式就有问题，不能刷新。

8 使用 connect-history-api-fallback 解决history模式刷新问题

9 npm i connect-history-api-fallback

```
const express = require('express')
const history = require('connect-history-api-fallback')
const app = express()
app.use(history())//必须在express.static之前use
app.use(express.static(__dirname__+'/static'))

app.get('person',(req,res)=>{
     res.send({
         name:'tom',
          age:18     
     })   
})

app.listen(5000,err=>{
    if(!err) console.log('服务器启动成功')
})
```