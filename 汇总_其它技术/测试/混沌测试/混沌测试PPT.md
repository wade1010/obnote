混沌工程的含义

混沌工程是在分布式系统上进行实验的学科 ,  目的是建立对系统抵御生产环境中失控条件的能力以及信心 。



实施混沌工程是分布式系统构建业务的必然选择。一方面架构的复杂性让系统负责人员很难自信承诺实际情况一定符合预期设计。另一方面组织对 ROI（投资回报率）的追求，又要求稳定性团队不能只是一个成本中心，所有措施要富有成效。业内不少工程师倾向于将混沌工程比作疫苗，通过"接种疫苗"的方式，让系统具备抵挡"重大疾病"的能力。



故障注入和故障测试是通过引入故障，让程序走入一些不常经过的路径，以此提高程序覆盖率，是对特定条件、变量的验证。

混沌工程虽然也使用短期度量结果代表系统状态，但该度量结果一般是监控指标，而非具体的接口返回值。

混沌工程是围绕稳态进行验证和探索的过程，比如混乱猴子随机杀死部分节点的行为，每次实验都可能产生新的数据。





将 ChaosBlade 的设计总结为这六点。使用 Golang 构建，实现跨平台，并且解压即用；工具使用采用 CLI 的方式，使用简单，具备完善的命令提示；遵循混沌实验模型定义场景接口，所有场景基于此接口实现，将模型转换为 cobra 框架所支持的命令参数，实现变量参数化、参数规范化，并且通过实验模型 Yaml 描述，可以很方便的实现多语言、多领域的场景扩展。而且将整个实验对象化，每个实验对象都会有个 UID，方便管理





![](https://gitee.com/hxc8/images5/raw/master/img/202407172356837.jpg)







重点来介绍一下这五项原则。第一条：”建立一个围绕稳定状态行为的假说“，其包含两个含义，一个是定义能直接反应业务服务的监控指标，需要注意的是这里的监控指标并不是系统资源指标，比如CPU、内存等，这里的监控指标是能直接衡量系统服务质量的业务监控。举个例子，一个调用延迟故障，请求的 RT 会变长，对上层交易量造成下跌的影响，那么这里交易量就可以作为一个监控指标。这条原则的另一个含义是故障触发时，对系统行为作出假设以及监控指标的预期变化。第二个指模拟生产环境中真实的或有理论依据的故障，第三个建议在生产环境中运行实验，但也不是说必须在生产环境中执行，只是实验环境越真实，混沌工程越有价值。持续的执行才能持续的降低故障复发率和提前发现故障，所以需要持续的自动化运行试验，最后一个，混沌工程很重要的一点是控制爆炸半径，也就是试验影响面，防止预期外的资损发生，后面会介绍控制爆炸半径的方式。依据这些指导原则可以更有效实施混沌工程，那么混沌工程的实施步骤是什么？



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356623.jpg)







![](https://gitee.com/hxc8/images5/raw/master/img/202407172356639.jpg)





![](https://gitee.com/hxc8/images5/raw/master/img/202407172356841.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356056.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356103.jpg)





http://aliyundian.com/post/189.html



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356189.jpg)



三、混沌工程的成熟度模型

混沌工程成熟度模型，Netflix （网飞）总结了两个维度，一个是复杂度，一个就是接受度。

前者表示的是混沌工程能有多复杂，而后者则表示的是混沌工程被团队的接受程度。

复杂度分为哪几个阶段：

 

![](https://gitee.com/hxc8/images5/raw/master/img/202407172356285.jpg)

接受度分为哪几个阶段：

![](https://gitee.com/hxc8/images5/raw/master/img/202407172356410.jpg)

我们目前处于起步发展阶段，线上生产环境实施混沌工程，风险很大，也不可控，因此：

我们在压测模拟环境实施混沌工程，搭建类似生产的小型模拟环境，以正常、合理的测试结果，作为基准“稳定状态”。在模拟测试的过程中，对系统实施各类混沌实验后，通过观察测试结果来评估系统的可靠性，从而寻找系统弱点，

登记Bug，进行修复。

同时，通过自动化运维平台，实现混沌实验异常注入和持续执行。



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356673.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356741.jpg)







![](https://gitee.com/hxc8/images5/raw/master/img/202407172356842.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356868.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172356944.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172357992.jpg)



![](https://gitee.com/hxc8/images5/raw/master/img/202407172357932.jpg)

