（1）单个类带虚函数的数据成员布局

类中引入虚函数时，会有额外的成本付出

 1 编译时，编译器会产生虚函数表

 2 对象中会产生 虚函数表指针vptr,用来指向虚函数表的；

 3 增加或扩展构造函数，增加给虚函数表指针vptr赋值的代码，让vptr指向虚函数表

 4 如果多重继承，比如你继承了两个父类，每个父类都有虚函数的话，每个父类都会有vptr,用继承时，子类就会把这两个vptr都继承过来。

子类与第一个基类公用一个vptr

 5 析构函数中也被扩展增加了虚函数表指针vptr相关的赋值代码，从反汇编代码来看感觉这个赋值代码似乎和构造函数代码相同。不明白什原因所以这里比较疑惑！！！

子类有虚函数时，单一继承父类没有虚函数和单一继承父类有虚函数，内存空间布局一样，虚函数都是排在最前面。

单个类带虚函数的数据成员布局：

![](https://gitee.com/hxc8/images2/raw/master/img/202407172212216.jpg)

单一继承父类带虚函数的数据成员布局

![](https://gitee.com/hxc8/images2/raw/master/img/202407172212386.jpg)

单一继承父类不带虚函数的数据成员布局

**跟上面父类带虚函数的布局一样**

![](https://gitee.com/hxc8/images2/raw/master/img/202407172212630.jpg)

而不是下图的布局

![](https://gitee.com/hxc8/images2/raw/master/img/202407172212011.jpg)