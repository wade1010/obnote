iftop命令配置解释

参数 含义

P通过此键可切换暂停/继续显示

h通过此键可在交互参数界面/状态输出界面之间来回切换

b通过此键可切换是否显示平均流量图形条

B通过此键可切换显示2秒、10秒、40秒内的平均流量

T通过此键可切换是否显示每个连接的总流量

j/k按j键或k键可以向上或向下滚动屏幕显示当前的连接信息

l通过此键可打开iftop输出过滤功能，比如输入要显示的IP，按回车后，屏幕就只显示与这个IP相关的流量信息

L通过此键可切换显示流量刻度范围，刻度不同，流量图形条会跟着变化

q通过此键可退出iftop流量监控界面

n通过此键可使iftop输出结果以IP或主机名的方式显示

s通过此键可切换是否显示源主机信息

d通过此键可切换是否显示远端目标主机信息

t通过此键可切换iftop显示格式，连续按此键可依次显示：以两行方式显示发送接收流量、以一行方式显示发送接收流量、只显示发送流量/只显示接收流量

N通过此键可切换显示端口号/端口号对应服务名称

S通过此键可切换是否显示本地源主机的端口信息

D通过此键可切换是否显示远端目标主机的端口信息

p通过此键可切换是否显示端口信息

<通过此键可根据左边的本地主机名或IP地址进行排序

> 通过此键可根据远端目标主机的主机名或IP地址进行排序o通过此键可切换是否固定显示当前的连接iftop的强大之处在于它能够实时显示网络的流量状态，监控网卡流量的来源IP和目标地址，这对于检测服务器网络故障、流量异常是非常有用的，只需通过一个命令就能把流量异常或网络故障的原因迅速定位，因此对于运维人员来说，iftop命令是必不可少的一个网络故障排查工具。


直接显示连接埠编号, 不显示服务名称:

iftop -N

显示某个网段进出封包流量

iftop -F 192.168.1.0/24 or 192.168.1.0/255.255.255.0

-i设定监测的网卡，如：# iftop -i eth1

-B 以bytes为单位显示流量(默认是bits)，如：# iftop -B

-n使host信息默认直接都显示IP，如：# iftop -n

-N使端口信息默认直接都显示端口号，如: # iftop -N

-F显示特定网段的进出流量，如# iftop -F 10.10.1.0/24或# iftop -F 10.10.1.0/255.255.255.0

-h（display this message），帮助，显示参数信息

-p使用这个参数后，中间的列表显示的本地主机信息，出现了本机以外的IP信息;

-b使流量图形条默认就显示;

-f这个暂时还不太会用，过滤计算包用的;

-P使host信息及端口信息默认就都显示;

-m设置界面最上边的刻度的最大值，刻度分五个大段显示，例：# iftop -m 100M

执行iftop -N -n -i eth1后界面为

```

19.1Mb            38.1Mb              57.2Mb               76.3Mb             95.4Mb  
+-----------------+-----------------+--------------------+--------------------+---------------------  
192.168.1.11                                  => 192.168.1.66                  5.3Mb  3.22Mb  3.20Mb  
                                             <=                               219kb  45.7kb  49.3kb  
192.168.1.11                                   => 192.168.1.29                 144kb  30.8kb  29.6kb  
                                             <=                               11.3Mb  2.38Mb  2.74Mb  
192.168.1.11                                  => 12.2.11.71                    0b   6.40kb  6.66kb  
                                             <=                               0b      0b      0b  
192.168.1.11                                  => 192.168.1.8                   2.63kb  1.43kb   932b  
                                             <=                               1.31kb  1.05kb   893b  
192.168.1.11                                   => 192.168.2.78                 2.53kb  1.54kb  2.15kb  
                                              <=                              160b    160b    187b  
192.168.1.11                                   => 111.126.195.69               0b    166b     69b  
                                              <=                              0b      0b      0b  
------------------------------------------------------------------------------------------------------  
TX:             cum:   9.70MB   peak:   15.6Mb                          rates:   15.4Mb  3.26Mb  3.23Mb  
RX:                    8.38MB           14.9Mb                                   11.5Mb  2.42Mb  2.79Mb  
TOTAL:                 18.1MB           30.5Mb                                   27.0Mb  5.69Mb  6.03Mb  

```

iftop界面含义如下

第一行：带宽显示

中间部分：外部连接列表，即记录了哪些ip正在和本机的网络连接

中间部分右边：实时参数分别是该访问ip连接到本机2秒，10秒和40秒的平均流量

=>代表发送数据，<= 代表接收数据

底部三行：表示发送，接收和全部的流量

底部三行第二列：为你运行iftop到目前流量

底部三行第三列：为高峰值

底部三行第四列：为平均值

TX：发送流量

RX：接收流量

TOTAL：总流量

Cumm：运行iftop到目前时间的总流量

peak：流量峰值

rates：分别表示过去 2s 10s 40s 的平均流量

通过iftop的界面很容易找到哪个ip在霸占网络流量，这个是ifstat做不到的。不过iftop的流量显示单位是Mb,这个b是bit，是位，不是字节，而ifstat的KB，这个B就是字节了，byte是bit的8倍。初学者容易被误导。

进入iftop的命令

进入iftop画面后的一些操作命令(注意大小写)

按h切换是否显示帮助;

按n切换显示本机的IP或主机名;

按s切换是否显示本机的host信息;

按d切换是否显示远端目标主机的host信息;

按t切换显示格式为2行/1行/只显示发送流量/只显示接收流量;

按N切换显示端口号或端口服务名称;

按S切换是否显示本机的端口信息;

按D切换是否显示远端目标主机的端口信息;

按p切换是否显示端口信息;

按P切换暂停/继续显示;

按b切换是否显示平均流量图形条;

按B切换计算2秒或10秒或40秒内的平均流量;

按T切换是否显示每个连接的总流量;

按l打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息;

按L切换显示画面上边的刻度;刻度不同，流量图形条会有变化;

按j或按k可以向上或向下滚动屏幕显示的连接记录;

按1或2或3可以根据右侧显示的三列流量数据进行排序;

按<根据左边的本机名或IP排序;

按>根据远端目标主机的主机名或IP排序;

按o切换是否固定只显示当前的连接;

按f可以编辑过滤代码，这是翻译过来的说法，我还没用过这个！

按!可以使用shell命令，这个没用过！没搞明白啥命令在这好用呢！

按q退出监控。