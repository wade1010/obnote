**3.**联合概率、条件概率与相互独⽴

联合概率：包含多个条件，且所有条件同时成⽴的概率

记作：P(A,B)

条件概率：就是事件A在另外⼀个事件B已经发⽣条件下的发⽣概率

记作：P(A|B)

相互独⽴：如果P(A, B) = P(A)P(B)，则称事件A与事件B相互独⽴。

贝叶斯公式

4.1 公式介绍

![](https://gitee.com/hxc8/images1/raw/master/img/202407172138431.jpg)

**4.2 **案例计算

那么思考题就可以套⽤⻉叶斯公式这样来解决：

P(喜欢|产品, 超重) = P(产品, 超重|喜欢)P(喜欢)/P(产品, 超重)

上式中，

**P(**产品**, **超重**|**喜欢**)**和**P(**产品**, **超重**)**的结果均为**0**，导致⽆法计算结果。这是因为我们的样本量太少了，不具有代表性。

本来现实⽣活中，肯定是存在职业是产品经理并且体重超重的⼈的，P(产品,超重)不可能为0；

⽽且事件“职业是产品经理”和事件“体重超重”通常被认为是相互独⽴的事件，

但是，根据我们有限的**7**个样本计算**“P(**产品**, **超重**) = P(**产品**)P(**超重**)”**不成⽴。

⽽朴素⻉叶斯可以帮助我们解决这个问题。

朴素⻉叶斯，简单理解，就是假定了特征与特征之间**相互独⽴**的⻉叶斯公式。

也就是说，朴素⻉叶斯，之所以朴素，就在于假定了特征与特征相互独⽴。

所以，思考题如果按照朴素⻉叶斯的思路来解决，就可以是

那么这个公式如果应⽤在⽂章分类的场景当中，我们可以这样看：

P(产品, 超重) = P(产品) * P(超重) = 2/7 * 3/7 = 6/49

p(产品, 超重|喜欢) = P(产品|喜欢) * P(超重|喜欢) = 1/2 * 1/4 = 1/8

P(喜欢|产品, 超重) = P(产品, 超重|喜欢)P(喜欢)/P(产品, 超重) = 1/8 * 4/7 / 6/49 = 7/12

![](https://gitee.com/hxc8/images1/raw/master/img/202407172138319.jpg)

公式分为三个部分：

P(C)：每个⽂档类别的概率(某⽂档类别数／总⽂档数量)

P(W│C)：给定类别下特征（被预测⽂档中出现的词）的概率

计算⽅法：P(F1│C)=Ni/N （训练⽂档中去计算）

Ni为该F1词在C类别所有⽂档中出现的次数

N为所属类别C下的⽂档所有词出现的次数和

P(F1,F2,…) 预测⽂档中每个词的概率

如果计算两个类别概率⽐较：

所以我们只要⽐较前⾯的⼤⼩就可以，得出谁的概率⼤

⽂章分类计算

需求：通过前四个训练样本（⽂章），判断第五篇⽂章，是否属于China类

![](https://gitee.com/hxc8/images1/raw/master/img/202407172138190.jpg)

计算结果

```
P(C|Chinese, Chinese, Chinese, Tokyo, Japan) -->
P(Chinese, Chinese, Chinese, Tokyo, Japan|C) * P(C) / P(Chinese, Chinese, Chinese, Tokyo, Japan) 
=
P(Chinese|C)^3 * P(Tokyo|C) * P(Japan|C) * P(C) / [P(Chinese)^3 * P(Tokyo) * P(Japan)]

# 这个文章是需要计算是不是China类，是或者不是最后的分母值都相同:

# 首先计算是China类的概率: 
P(Chinese|C) = 5/8
P(Tokyo|C) = 0/8
P(Japan|C) = 0/8

# 接着计算不是China类的概率:
P(Chinese|C`) = 1/3
P(Tokyo|C`) = 1/3
P(Japan|C`) = 1/3
```