[boston_house.csv](attachments/WEBRESOURCE2fce083585a977ba24fa8809393caa34boston_house.csv)

![](https://gitee.com/hxc8/images1/raw/master/img/202407172144392.jpg)

```
from sklearn.linear_model import LinearRegression,SGDRegressor
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error
import pandas as pd
import numpy as np

data = np.loadtxt('./dataset/boston_house.csv', delimiter=',',skiprows=1)
print("装载原始数据维度：", data.shape)
features = data[:, :-1]
prices = data[:, -1]

#正规方程
def linear_model_1():
    # 数据集划分
    x_train,x_test,y_train,y_test = train_test_split(features,prices,random_state=22)
    # 特征工程化-标准化
    transfer = StandardScaler()
    x_train = transfer.fit_transform(x_train)
    x_test = transfer.fit_transform(x_test)
    # 机器学习-线性回归（正规方程）
    estimator = LinearRegression()
    estimator.fit(x_train,y_train)

    # 模型评估
    # 获取系数等值
    y_predict = estimator.predict(x_test)
    print("预测值为:\n", y_predict)
    print("模型中的系数为:\n", estimator.coef_)
    print("模型中的偏置为:\n", estimator.intercept_)

    # 评价
    # 均方误差
    error = mean_squared_error(y_test,y_predict)
    print('误差为：',error)

    return None
    
    
# 梯度下降法
def linear_model_2():
    x_train,x_test,y_train,y_test = train_test_split(features,prices,random_state=22)

    # 特征工程-标准化
    transfer = StandardScaler()
    x_train = transfer.fit_transform(x_train)
    x_test = transfer.fit_transform(x_test)

    # 机器学习
    estimator = SGDRegressor(max_iter=1000)
    #我们也可以尝试去修改学习率
    # estimator = SGDRegressor(max_iter=1000,learning_rate="constant",eta0=0.1)
    estimator.fit(x_train,y_train)

    #模型评估
    y_predict = estimator.predict(x_test)
    print("预测值为:\n", y_predict)
    print("模型中的系数为:\n", estimator.coef_)
    print("模型中的偏置为:\n", estimator.intercept_)


    # 评价
    # 均方误差
    error = mean_squared_error(y_test,y_predict)
    print("误差为:\n", error)
    return None
    
    linear_model_1()
    linear_model_2()
    
    
```

```
 linear_model_1()输出
 预测值为:
 [28.45463545 31.29683885 20.36108267 31.42231988 19.14884972 17.83870789
 20.42698809 18.52606977 18.50075521 33.10513012 20.16601307 26.8827206
 14.74441579 19.26701213 37.34211172 18.23097974  7.45908216 17.6546334
 30.54144288 23.74913838 17.57627471 33.73766589 28.55234934 16.87317815
 34.86926214 26.05713095 34.88677716 26.68904962 18.51265935 13.43300942
 30.16240675 14.47477467 37.2902304  11.67235683 15.03880943 15.3114663
  8.00483671 18.65060246 39.77118475 28.60659876 24.74407137 16.29238633
 37.68141922  5.17909732 20.67806193 24.4262853  18.93426447 20.05388528
 14.97264092 26.56196852  7.21198845 27.21677813 29.17326587 16.50755856
  7.53086488 35.38555102 32.27262573 20.94650592 16.30671287 20.93636157
 22.90745197 23.53244562 19.51961305 38.43687333 23.99987304 18.3577348
 12.15582859  6.17570504 41.88711122 21.15601422 15.76033319 21.75675344
 40.83994865 20.6018631  36.80215028 27.14207659 20.20562125 19.42663615
 24.81005728 21.439509   31.12140037 19.31305917 22.31609529 31.13622132
 26.32209713 19.90129335 28.71226006 21.07386035 26.09645357 19.32349287
 24.7189267  21.9257832  18.39139983 22.7360172  13.57429814 16.77201116
 24.08227934 15.63023    19.42067433 26.8091006  19.65454256 16.63948798
 23.90126778 22.80048799 21.03667186 36.25138274 14.71609032 20.59981575
 32.43688645 32.94351409 19.82482577 26.46098662 21.02984965 16.1835417
 20.80903383 20.65326082 26.9267777  24.30848142 23.25023576 13.19038561
 16.33603916  2.48763099 28.88642207 19.24284389 21.46888609 27.69468275
 28.58781792]
模型中的系数为:
 [-0.01529485  1.06931047 -0.01952081  0.7635347  -1.87455414  2.7696725
 -0.07719881 -3.16381397  2.10488963 -1.82512166 -1.72131129  0.92468148
 -4.05194008]
模型中的偏置为:
 22.62137203166228
误差为： 20.647291002546975
```

```
linear_model_2()输出
预测值为:
 [28.44022309 31.54441378 20.68995357 31.45392973 19.34907704 17.57517226
 20.68579845 18.53852052 18.7150193  32.94979386 20.54528862 26.49047987
 14.53176478 19.13629909 37.33473664 18.24552756  7.52151338 17.77614347
 30.81900348 23.95509651 17.24553053 33.84759511 28.21642582 16.44343228
 34.93464215 26.19712281 34.91216273 27.00549868 18.07709774 14.38749702
 30.28005203 13.07899127 37.9855176  11.12815941 15.18737222 14.75802914
  7.54056815 18.26876315 39.92257975 29.09096784 24.88291122 16.07952525
 37.67054779  4.57480597 20.30827042 24.35761082 19.0459224  19.9415359
 14.74332371 26.2752916   7.85568399 27.17613807 29.25214669 16.00505613
  7.15011645 35.46818973 31.90315021 22.18525674 16.35063231 21.0102646
 23.11717046 23.51690403 19.7850795  38.419518   25.25567628 17.95907366
 11.77517165  5.53425406 42.03122721 21.2921255  15.1914823  21.9580174
 41.08533342 21.17204162 36.94461149 27.19530275 21.26837768 19.68219594
 25.08377237 23.05299649 31.61838116 19.40978558 22.32470749 31.51384781
 26.7427491  19.68022778 28.85591641 21.27425353 26.46660757 17.95452036
 24.87389279 21.82075356 18.08486255 22.43075903 13.23183678 16.46050821
 24.06848526 15.22103177 18.957439   26.80090144 19.32526921 16.42368805
 23.72297564 22.72192653 19.74882467 36.18563497 14.87240508 21.7763154
 32.6116878  32.52406604 19.84874673 25.74075213 21.26211407 16.5708024
 20.81339524 21.21739825 27.18877962 24.91607914 23.23661707 12.73423238
 15.98595305  1.74180157 29.10855786 18.91460644 21.68857883 27.93717582
 28.31801311]
模型中的系数为:
 [ 0.04421935  0.91286476 -0.41768534  0.7918594  -1.72398511  2.84919439
 -0.17534976 -3.00553937  1.32899173 -1.04928724 -1.73626284  0.92901519
 -4.04232636]
模型中的偏置为:
 [22.62433336]
误差为:
 20.643438160016924
```